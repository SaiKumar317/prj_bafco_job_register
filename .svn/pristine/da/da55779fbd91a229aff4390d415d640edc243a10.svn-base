import React, { useContext, useEffect, useRef } from "react";
import CostEntry from "./CostEntry";
import Documents from "./Documents";
import JobCharges from "./JobCharges";
import MoveCost from "./MoveCost";
import GotoInvoice from "./GotoInvoice";
import JobOrders from "./JobOrders";
import JobDetailsTab from "./JobDetailsTab";
import { JobContext } from "../../context/JobContext";

function BodyTabs({ activeBodyTab, setBodyTab }) {
  const { selectedJob, fetchCostEntryDetails } = useContext(JobContext);
  const previousJobIdRef = useRef(null);
  useEffect(() => {
    if (selectedJob?.jobId && selectedJob.jobId !== previousJobIdRef.current) {
      console.log("useEffect - fetchCostEntryDetails", selectedJob.jobId);
      fetchCostEntryDetails(selectedJob.jobId);
      previousJobIdRef.current = selectedJob.jobId;
    }
  }, []);
  return (
    <>
      {/* Checkboxes */}

      {/* Body Tabs */}
      <div className="tabs">
        {[
          "Job Details",
          "Cost Entry",
          "Move Cost",
          "Goto/Invoice",
          "Job Charges",
          "Job Orders",
          "Documents",
        ].map((tab) => (
          <button
            key={tab}
            className={`tab ${activeBodyTab === tab ? "active" : ""}`}
            onClick={() => setBodyTab(tab)}
          >
            {tab}
          </button>
        ))}
      </div>

      {/* Tab Content */}
      <div className="body-tab-content">
        {activeBodyTab === "Job Details" && <JobDetailsTab />}
        {activeBodyTab === "Cost Entry" && <CostEntry />}
        {activeBodyTab === "Move Cost" && <MoveCost />}
        {activeBodyTab === "Goto/Invoice" && <GotoInvoice />}
        {activeBodyTab === "Job Charges" && <JobCharges />}
        {activeBodyTab === "Job Orders" && <JobOrders />}
        {activeBodyTab === "Documents" && <Documents />}
      </div>
    </>
  );
}

export default BodyTabs;
