SELECT 
   distinct h.sVoucherNo,

   --Header UI (box1)
    ISNULL(js.sName, '') AS jobStatus,
    ISNULL(ot.sName, '') AS operationType,
    ISNULL(st.sName, '') AS serviceType,
	ISNULL(t.iTag3008, 0) AS jobId,
    ISNULL(j.sName, '') AS jobName,
    ISNULL(j.sCode, '') AS jobCode,
    convert (nvarchar, dbo.IntToDate(h.iDate),103) AS docDate,
	ISNULL(eh.ServiceOrderId, '') AS serviceOrderId,
    ISNULL(br.sName, '') AS branch,
    ISNULL(ca.sName, '') AS customerAcc,
    ISNULL(hb.sName, '') AS handleBy,
    ISNULL(s.sName, '') AS salesman,
    ISNULL(di.sName, '') AS division,
    ISNULL(cc.sName, '') AS costCenter,
	--Header UI (box1)
	--Header UI (box2)
    ISNULL(eh.PORef, '') AS PORef,
    ISNULL(sc.sName, '') AS ShippingConsignmentCode,
    ISNULL(eh.FreightTerms, '') AS freightTerms,
    ISNULL(sl.sName, '') AS shippingLine,
   '' AS vessel,
   '' AS voyage,
    '' AS portLoading,
    '' AS portDestination,
    ISNULL(convert (nvarchar, dbo.IntToDate(eh.PeriodFrom),103),'') AS arrival,
    ISNULL(convert (nvarchar, dbo.IntToDate(eh.PeriodTo),103),'') AS departure,
	'' AS finalDestination,
	ISNULL(eh.BookedContainer, '') AS bookedContainer,
    ISNULL(gt.sName, '') AS goodsType,
    ISNULL(eh.DGClass, '') AS dgClass,
    ISNULL(eh.JobCommodity, '') AS jobCommodity,
    ISNULL(pm.sName, '') AS pickupPlace,
    ISNULL(dpm.sName, '') AS dropofPlace,
    ISNULL(eh.MblNoHeader, '') AS MblNoHeader,
    ISNULL(eh.HblNoHeader, '') AS HblNoHeader,
    ISNULL(eh.Weight_KGS_, '') AS weightKgs,
    ISNULL(eh.Measurement_C_B_M_, '') AS measurementCbm,
    ISNULL(eh.CargoAwb, '') AS cargoAwb,
    ISNULL(eb.BayanNo, '') AS bayanNo,
    '' AS vendorCustId,
    '' AS bookinType,
    '' AS overseasAgent,
    ISNULL(nt.sName, '') AS networkType,
	ISNULL(eh.Notes, '') AS notes,
	ISNULL(eh.Notes, '') AS notes,
	--Header UI (box2)
	-- body UI
    ISNULL(ct.sName, '') AS containerType,
	ISNULL(eb.ContainerNo, '') AS containerNo,
	ISNULL(eb.SealNo_, '') AS sealNo,
	ISNULL(bsd.mInput1, 0) AS bAge,
	ISNULL(bsd.mInput0, 0) AS sAge,
	ISNULL(convert (nvarchar, dbo.IntToDate(eb.DateShuttle),103),'') AS dateShuttle,
	ISNULL(convert (nvarchar, dbo.IntToDate(eb.DateAgeIn),103),'') AS dateAgeIn,
   h.iHeaderId
FROM tCore_Header_0 h
JOIN tCore_HeaderData5639_0 eh ON eh.iHeaderId = h.iHeaderId
JOIN tCore_Data_0 d ON d.iHeaderId = h.iHeaderId
 JOIN tCore_Data5639_0 eb ON eb.iBodyId = d.iBodyId
 JOIN tCore_IndtaBodyScreenData_0 bsd on bsd.iBodyId = d.iBodyId
LEFT JOIN tCore_Data_Tags_0 t ON t.iBodyId = d.iBodyId
LEFT JOIN mCore_joborder j ON j.iMasterId = t.iTag3008
LEFT JOIN mCore_shippingline sl ON sl.iMasterId = t.iTag3007
LEFT JOIN mCore_jobstatus js ON js.iMasterId = t.iTag3009
--LEFT JOIN mCore_port pl ON pl.iMasterId = eh.PortofLoading
--LEFT JOIN mCore_port pd ON pd.iMasterId = eh.PortofDestination
LEFT JOIN mCore_handleby hb ON hb.iMasterId = t.iTag3038
LEFT JOIN mCore_branch br ON br.iMasterId = t.iTag3002
LEFT JOIN mCore_salesman s ON s.iMasterId = t.iTag3010
LEFT JOIN mCore_operationtype ot ON ot.iMasterId = t.iTag3014
LEFT JOIN mCore_networktype nt ON nt.iMasterId = t.iTag3011
LEFT JOIN mCore_servicetype st ON st.iMasterId = t.iTag3016
LEFT JOIN mCore_shipconsg sc ON sc.iMasterId = t.iTag3017
LEFT JOIN mCore_CostCenter cc ON cc.iMasterId = t.iTag5
LEFT JOIN mCore_goodstype gt ON gt.iMasterId = t.iTag3015
LEFT JOIN mCore_placemaster pm ON pm.iMasterId = eh.PickupPlace
LEFT JOIN mCore_placemaster dpm ON dpm.iMasterId = eh.DropofPlace
--LEFT JOIN mCore_Account vcbi on vcbi.iMasterId = eh.VendorCustomBrokerId
--LEFT JOIN mCore_overseasagent oa on oa.iMasterId = t.iTag3004
LEFT JOIN mCore_containertype ct on ct.iMasterId = t.iTag3019
LEFT JOIN mCore_division di ON di.iMasterId = d.iFaTag
LEFT JOIN mCore_Account ca on ca.iMasterId = d.iBookNo
WHERE h.iVoucherType IN (5639) --Storage & Handling Job

--select * from cCore_MasterDef where sMasterName like '%container%'

--select * from cCore_Vouchers_0 where sName like '%storage%' --Storage & Handling Job 5639

--SELECT      c.name  AS 'ColumnName'
--            ,t.name AS 'TableName'
--FROM        sys.columns c
--JOIN        sys.tables  t   ON c.object_id = t.object_id
--WHERE       c.name LIKE '%caption%'
--ORDER BY    TableName ,ColumnName;


--select * from cCore_MasterView